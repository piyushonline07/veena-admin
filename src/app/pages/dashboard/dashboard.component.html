<div class="dashboard-container">
  <!-- Stats Summary Cards -->
  <div class="stats-grid">
    <div class="stat-card dau-card">
      <div class="stat-icon">
        <i class="pi pi-users"></i>
      </div>
      <div class="stat-content">
        <span class="stat-label">Daily Active Users</span>
        <span class="stat-value">{{ totalDAU | number }}</span>
        <span class="stat-trend positive">
          <i class="pi pi-arrow-up"></i>
          {{ dauGrowth }}% vs yesterday
        </span>
      </div>
    </div>

    <div class="stat-card mau-card">
      <div class="stat-icon">
        <i class="pi pi-chart-line"></i>
      </div>
      <div class="stat-content">
        <span class="stat-label">Monthly Active Users</span>
        <span class="stat-value">{{ totalMAU | number }}</span>
        <span class="stat-trend positive">
          <i class="pi pi-arrow-up"></i>
          {{ mauGrowth }}% vs last month
        </span>
      </div>
    </div>

    <div class="stat-card retention-card">
      <div class="stat-icon">
        <i class="pi pi-heart"></i>
      </div>
      <div class="stat-content">
        <span class="stat-label">Retention Rate</span>
        <span class="stat-value">{{ retentionRate | number:'1.1-1' }}%</span>
        <span class="stat-trend positive">
          <i class="pi pi-info-circle"></i>
          30-day active retention
        </span>
      </div>
    </div>

    <div class="stat-card avg-card">
      <div class="stat-icon">
        <i class="pi pi-clock"></i>
      </div>
      <div class="stat-content">
        <span class="stat-label">Avg. Engagement</span>
        <span class="stat-value">{{ avgSessionMinutes | number:'1.1-1' }} min</span>
        <span class="stat-trend positive">
          <i class="pi pi-info-circle"></i>
          Daily per user
        </span>
      </div>
    </div>

    <div class="stat-card cost-card">
      <div class="stat-icon">
        <i class="pi pi-dollar"></i>
      </div>
      <div class="stat-content">
        <span class="stat-label">AWS Monthly Cost</span>
        <span class="stat-value">{{ serverCost }} {{ costUnit }}</span>
        <span class="stat-trend">
          <i class="pi pi-calendar"></i>
          Estimate for {{ currentMonth }}
        </span>
      </div>
    </div>
  </div>

  <!-- Charts Grid -->
  <div class="charts-grid">
    <!-- DAU Chart -->
    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-title">
          <i class="pi pi-chart-bar"></i>
          <span>Daily Active Users</span>
        </div>
        <span class="chart-subtitle">Last 14 days</span>
      </div>
      <div class="chart-container">
        <p-chart type="line" [data]="dauChartData" [options]="dauChartOptions" [height]="'100%'"></p-chart>
      </div>
    </div>

    <!-- MAU Chart -->
    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-title">
          <i class="pi pi-chart-line"></i>
          <span>Monthly Active Users</span>
        </div>
        <span class="chart-subtitle">Last 12 months</span>
      </div>
      <div class="chart-container">
        <p-chart type="line" [data]="mauChartData" [options]="mauChartOptions" [height]="'100%'"></p-chart>
      </div>
    </div>
  </div>

  <!-- Trending Media Section -->
  <div class="trending-section mt-4">
    <div class="chart-card">
      <div class="chart-header">
        <div class="chart-title">
          <i class="pi pi-bolt"></i>
          <span>Top Performing Media</span>
        </div>
        <span class="chart-subtitle">Real-time trending based on play counts</span>
      </div>
      <div class="p-4">
        <p-table [value]="trendingMedia" styleClass="p-datatable-sm" [responsive]="true">
          <ng-template pTemplate="header">
            <tr>
              <th style="width: 80px">Rank</th>
              <th>Media Title</th>
              <th>Type</th>
              <th style="width: 150px">Total Plays</th>
              <th style="width: 200px">Last Updated</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-item>
            <tr>
              <td>
                <span class="rank-badge" [class.top-3]="item.rank <= 3">
                  {{item.rank}}
                </span>
              </td>
              <td>
                <div class="flex align-items-center gap-2">
                  <span class="font-bold">{{item.media.title}}</span>
                </div>
              </td>
              <td>
                <p-tag [value]="item.media.mediaType"
                  [severity]="item.media.mediaType === 'VIDEO' ? 'primary' : 'success'"></p-tag>
              </td>
              <td class="font-medium">{{item.playCount | number}}</td>
              <td class="text-secondary text-sm">{{item.updatedAt | date:'medium'}}</td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="5" class="text-center p-4">No trending data available yet.</td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  </div>
</div>